package com.frameworkset.sqlexecutor;
/**
 * Copyright 2023 bboss
 * <p>
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * <p>
 * http://www.apache.org/licenses/LICENSE-2.0
 * <p>
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import com.frameworkset.common.poolman.SQLExecutor;
import com.frameworkset.common.poolman.util.DBConf;
import com.frameworkset.common.poolman.util.SQLManager;
import com.frameworkset.orm.adapter.DBClickhouse;
import com.frameworkset.util.ListInfo;
import com.frameworkset.util.SimpleStringUtil;
import org.frameworkset.spi.assemble.PropertiesContainer;
import org.frameworkset.spi.assemble.PropertiesUtil;
import org.junit.Test;

import java.sql.SQLException;
import java.util.List;
import java.util.Map;

/**
 * <p>Description: </p>
 * <p></p>
 *
 * @author biaoping.yin
 * @Date 2023/12/27
 */
public class TestPostgresqlDB {
    @Test
    public   void testDB() throws SQLException {
//        SQLUtil.startPool("test",//数据源名称
//                "com.github.housepower.jdbc.ClickHouseDriver",//oracle驱动
//                "jdbc:clickhouse://101.13.6.4:29000,101.13.6.7:29000,101.13.6.6:29000/visualops",//oracle rac链接串
//                "default",null,//数据库账号和口令
//                "select 1 " //数据库连接校验sql
//        );//初始化数据源
        DBConf tempConf = new DBConf();
        tempConf.setPoolname("test");
        tempConf.setDriver("org.postgresql.Driver");
        tempConf.setJdbcurl( "jdbc:postgresql://10.19.32.210:5432/postgres");
        tempConf.setUsername("postgres");
        tempConf.setPassword("1qazPostgres");
        tempConf.setValidationQuery("select 1 ");
        //tempConf.setTxIsolationLevel("READ_COMMITTED");
        tempConf.setJndiName("jndi-test");
        PropertiesContainer propertiesContainer = PropertiesUtil.getPropertiesContainer();
        int initialConnections = propertiesContainer.getIntProperty("initialConnections",5);
        tempConf.setInitialConnections(initialConnections);
        int minimumSize = propertiesContainer.getIntProperty("minimumSize",5);
        tempConf.setMinimumSize(minimumSize);
        int maximumSize = propertiesContainer.getIntProperty("maximumSize",10);
        tempConf.setMaximumSize(maximumSize);
        tempConf.setUsepool(true);
 
        boolean showsql = propertiesContainer.getBooleanProperty("showsql",true);
        tempConf.setShowsql(showsql);
        tempConf.setQueryfetchsize(null);
  
      
        SQLManager.startPool(tempConf);
//        List<Map> ddd = SQLExecutor.queryList(Map.class,"select * from public.langchain_pg_embedding offset ? limit ? ",0,1);
//        System.out.println(SimpleStringUtil.object2json(ddd));
//        ListInfo datas = SQLExecutor.queryListInfo(Map.class,"select * from public.langchain_pg_embedding  ",0,2);
//        System.out.println(SimpleStringUtil.object2json(datas));
        List<Map> ss = SQLExecutor.queryList(Map.class," select * from (SELECT (1 - (embedding <=> '[3,1,2]')) AS cosine_similarity FROM public.items) where cosine_similarity > 0.8");

        System.out.println(SimpleStringUtil.object2json(ss));
        
//        String sql = "SELECT b.kn_id, b.task_id, b.title, b.docdescribe, b.kn_key_words, b.kn_catalog, b.kn_source, b.kn_area_name," +
//                " b.kn_role_name, b.kn_base,  b.oss_id, b.valid_date, b.expire_date, b.state, b.create_time, b.create_op_name, b.update_time," +
//                " b.update_op_name, b.remark, b.ext1, b.ext2, b.tmpl_name,b.tmpl_id , 1 - (e.embedding <=> %(queryCondition)s) AS similarity " +
//                "FROM ucr_chan_model.kn_inst_base b left join ucr_chan_model.kn_inst_embedding e on b.kn_id = e.kn_id " +
//                "where 1=1  and b.tmpl_name like %套餐计费% " +
//                "and b.create_op_name like 'admin' " +
//                "and b.role_cmetadata ?| ['admin'] and b.area_cmetadata ?| ['731', '730'] " +
//                "and b.update_time BETWEEN %(update_time_start)s AND %(update_time_end)s " +
//                "and e.embedding_type in ('3','4') and b.state = %(state)s  " +
////                "and 1 - (e.embedding <=> %(queryCondition)s) >= %(similarity_score)s " +
//                "order by similarity offset %(offset)s limit %(limit)s";
//        ss = SQLExecutor.queryList(Map.class,sql);
//        System.out.println(SimpleStringUtil.object2json(ss));

        String sql = "SELECT e.kn_id,1 - (e.embedding <=> '[0.0037139414343982935, -0.03436264768242836, -0.02966061607003212, 0.04305531084537506, -0.003602546639740467, -0.0011795238824561238, -0.014307397417724133, -0.023669380694627762, 0.02146964892745018, 0.0073777614161372185, 0.01237974688410759, 0.01936524361371994, 0.013516908511519432, -0.00527459429576993, -0.006383276078850031, 0.00531381368637085, 0.004246037919074297, 0.0009906258201226592, -0.018573489040136337, -0.00885749515146017, 0.013009998016059399, 0.020815227180719376, -0.014867777936160564, -0.019281158223748207, 0.02689504064619541, -0.01609490066766739, -0.0037939059548079967, 0.008793685585260391, 0.023236699402332306, -0.013612143695354462, -0.03500877693295479, 0.011001761071383953, 0.020369762554764748, 0.018333937972784042, 0.0012100983876734972, 0.0010137376375496387, -0.02304876036942005, 0.016862109303474426, 0.003914439585059881, -0.012534502893686295, 0.0038604228757321835, -0.006910305470228195, -0.0047537642531096935, -0.03134701028466225, 0.019436819478869438, -0.008714222349226475, -0.018467534333467484, -0.057900529354810715, -9.148109529633075e-05, -0.0116786640137434, 0.013053356669843197, -0.020974602550268173, -0.013152575120329857, 0.024304507300257683, -0.01351625844836235, -0.005117361433804035, 0.0022367825731635094, -0.010944691486656666, -0.020543880760669708, -0.007644811179488897, 0.016901299357414246, 0.17239253222942352, 0.004441042896360159, 0.015566851943731308, 0.02045804262161255, -0.006166150793433189, 0.008502457290887833, 0.005853051785379648, -0.020686183124780655, 0.004610423929989338, 0.0017266077920794487, 0.027679748833179474, 0.011952312663197517, 0.002717118477448821, 0.021232014521956444, -0.002375425072386861, -0.026090454310178757, 0.009733021259307861, -0.011447963304817677, -0.015014725737273693, -0.019494792446494102, 0.01973753422498703, 0.024340244010090828, -0.01708824560046196, 0.01920127309858799, -0.008231948129832745, 0.018733637407422066, 0.7593673467636108, -0.011248799040913582, 0.02662489004433155, 0.01288904994726181, -0.011232160963118076, -0.013847434893250465, 0.008915543556213379, -0.013532853685319424, 0.011959630064666271, -0.01670019142329693, -0.0038313698023557663, 0.007408248260617256, 0.017124047502875328, 0.0211978517472744, -0.0083115603774786, -0.013413539156317711, -0.013240132480859756, -0.02210293710231781, 0.0046822139993309975, -0.03728945925831795, -0.03735770657658577, -0.018171949312090874, 0.0031544219236820936, 0.016408391296863556, -0.036513350903987885, -0.03645212575793266, -0.010924430564045906, 0.008413080126047134, -0.009044083766639233, 0.006938362494111061, 0.021885152906179428, 0.02457335777580738, 0.01782977394759655, -0.012999697588384151, 0.044865675270557404, 0.0022276246454566717, -0.027451341971755028, 0.0034144995734095573, -0.0065081799402832985, -0.01705850474536419, -0.013570183888077736, 0.0006270731100812554, 0.006574538070708513, 0.0009102543699555099, -0.023422274738550186, -0.005480686668306589, 0.004174100235104561, -0.010539856739342213, 0.012988430447876453, 0.002140151569619775, 0.01429405715316534, -0.005388389807194471, 0.0008274659630842507, 0.020656853914260864, -0.028582215309143066, 0.016603758558630943, -0.032374314963817596, 0.01697026938199997, -0.023283975198864937, -0.0017912163166329265, 0.013584756292402744, 0.014126809313893318, -0.016035480424761772, 0.023854190483689308, -0.027339095249772072, -0.009655185043811798, -0.007034513633698225, 0.0037103467620909214, 0.0021849970798939466, -0.0077376896515488625, -0.0220235176384449, 0.01669670268893242, -0.005191444884985685, 0.010149051435291767, -0.0014942832058295608, 0.016808241605758667, -0.0367431677877903, -0.0007391397375613451, -0.019050275906920433, 0.019481537863612175, -0.017752550542354584, 0.009034591726958752, 0.029077695682644844, -0.025102566927671432, 0.015337828546762466, 0.0045476951636374, 0.027813365682959557, 0.0346677228808403, -0.019748127087950706, -0.004769799765199423, 0.004644186235964298, -4.78739311802201e-05, -0.0030333464965224266, 0.020133808255195618, 0.02101719006896019, 0.020643452182412148, -0.03833789378404617, -0.012603308074176311, 0.03398535028100014, 0.007660923060029745, -0.0011099977418780327, -0.02474784478545189, -0.023068053647875786, 0.004623538348823786, 0.027570035308599472, 0.01997419074177742, -0.01716763526201248, -0.006944598630070686, -0.014973876066505909, -0.006677018478512764, -0.007421072106808424, 0.006137261167168617, 0.010737969540059566, -0.020192498341202736, 0.03176166117191315, 0.01333872601389885, 0.014156552031636238, 0.013494077138602734, -0.0030087183695286512, 0.029728922992944717, 0.003641825634986162, 0.02283678948879242, 0.019149543717503548, -0.0309207271784544, -0.002178614493459463, 0.03344530984759331, 0.011518510058522224, -0.023436985909938812, 0.020069772377610207, -0.014226620085537434, 8.517536480212584e-05, 0.012778679840266705, 0.014645321294665337, 0.014953126199543476, 0.002747401362285018, -0.022479476407170296, -0.0036022081039845943, 0.003113372949883342, 0.009968406520783901, 0.014330258592963219, 0.007661798968911171, -0.007286549545824528, 0.004847601987421513, -0.03274970501661301, -0.016528593376278877, -0.01123441755771637, -0.009488876909017563, -0.0019530949648469687, 0.011941524222493172, 0.0020462842658162117, -0.0019390969537198544, -0.05111432448029518, -0.011299503967165947, -0.012909987010061741, 0.0147582171484828, -0.005957773886620998, -0.01688549853861332, 0.0026521170511841774, 0.0015704234829172492, 0.010435481555759907, 0.02762077935039997, 0.0034809885546565056, -0.0036488336045295, -0.012177564203739166, -0.013935405761003494, 0.014253775589168072, -0.04330558329820633, 0.013064512982964516, -0.041493598371744156, -0.005979438778012991, -0.025497937574982643, 0.015067611820995808, -0.0021771083120256662, 0.031093550845980644, -0.02788807451725006, 0.012067084200680256, -0.012952744960784912, 0.00031783906160853803, 0.0007678014226257801, 0.006133107468485832, 0.008367099799215794, -0.0002269435062771663, -0.036493901163339615, 0.0010753432288765907, 0.012001780793070793, -0.0002042134292423725, -0.018107445910573006, 0.004324367735534906, 0.028720472007989883, -0.012264573946595192, 0.012357023544609547, 0.008217781782150269, -0.016072051599621773, -0.020087765529751778, 0.011101256124675274, -0.04118366539478302, 0.01885484717786312, 0.006412389688193798, 0.001459332648664713, -0.0042141396552324295, -0.018381696194410324, 0.0019496828317642212, 0.014373530633747578, -0.025235090404748917, -0.00501938397064805, 0.008859102614223957, -0.011533226817846298, 0.004717379808425903, 0.028251122683286667, 0.027819108217954636, 0.013209613040089607, -0.011161896400153637, -0.015020591206848621, 0.015485105104744434, -0.016314731910824776, 0.005155379418283701, 0.00790813472121954, -0.011961241252720356, 0.02150120958685875, -0.02265853062272072, 0.019509028643369675, -0.008726163767278194, 0.00968693196773529, -0.030582888051867485, -0.02921181172132492, 0.013566294685006142, -0.020525377243757248, 0.006739228963851929, -0.01047747116535902, 0.018860166892409325, -0.004518131725490093, -0.04288051277399063, 0.010269618593156338, 0.005020788870751858, -0.014356502331793308, -0.03229595720767975, -0.048904210329055786, 0.01541735790669918, 0.04704589024186134, 0.0069441646337509155, -0.0039440966211259365, -0.0205170176923275, 0.007100281305611134, 0.004596219398081303, 0.012221149168908596, -0.007326704915612936, -0.010255290195345879, -0.013410321436822414, 0.0068300277926027775, 0.03553367033600807, 0.004971387330442667, -0.01651221327483654, 0.03785407915711403, 0.014801791869103909, -0.005595675203949213, 0.0069172075018286705, -0.057068485766649246, 0.01145403366535902, 0.008377527818083763, 0.0028310022316873074, 0.02033447101712227, 0.004505581222474575, 0.000924202729947865, 0.01614631898701191, 0.030125129967927933, 0.03181018307805061, -0.00852222554385662, 0.03316326439380646, -0.02378140203654766, -0.0355704203248024, 0.007859507575631142, 0.004217175766825676, 0.0007126841228455305, -0.017102224752306938, 0.03044300153851509, 0.00835470948368311, -0.0031076944433152676, -0.0030577112920582294, -0.025321979075670242, -0.018706053495407104, 0.009885616600513458, -0.020197348669171333, -0.03134474158287048, 0.021558813750743866, 0.013969123363494873, 0.01753544993698597, -0.02845025435090065, 0.020756583660840988, -0.02399986796081066, -0.002361591439694166, -0.012933047488331795, 0.027323096990585327, 0.015429206192493439, -0.011593486182391644, 0.017147352918982506, 0.0002323748922208324, 0.007722292095422745, 0.00511829974129796, -0.00885489210486412, -0.011711448431015015, 0.020393984392285347, -0.013619478791952133, -0.014759364537894726, 0.004640297498553991, -0.03407832607626915, 0.006830506958067417, 0.0010727726621553302, -0.014944612979888916, 0.022166850045323372, 0.0033194900024682283, 0.019606437534093857, -0.015066378749907017, 0.0383845753967762, -0.01234683208167553, -0.007121261674910784, -0.0025356553960591555, -0.2037884145975113, 0.024143528193235397, -0.002494484419003129, 0.017837312072515488, 0.010273115709424019, -0.006298561580479145, 0.022909801453351974, -0.020997289568185806, -0.047127705067396164, -0.03315228968858719, -0.0026174362283200026, -0.005597913637757301, -0.005702924448996782, -0.03079543448984623, 0.008120181038975716, 0.012594151310622692, 0.010291407816112041, 0.024613020941615105, -0.010859732516109943, -0.0031454151030629873, -0.006644688080996275, 0.005056783091276884, -0.009945191442966461, 0.0020006136037409306, -0.008362575434148312, -0.020065708085894585, -0.006310971453785896, 0.004227867815643549, -0.004387402441352606, -0.01292747724801302, -0.0022352063097059727, 0.02950243465602398, -0.029811525717377663, -0.03617876395583153, -0.017740894109010696, -0.03123101033270359, -0.030716994777321815, 0.011749310418963432, 0.02629806101322174, -0.005376407410949469, -0.0024725201074033976, -0.031514473259449005, -0.005028721410781145, -0.01800159551203251, -0.035628486424684525, -0.011336443945765495, -0.048255935311317444, -0.00024036980175878853, -0.014190949499607086, 0.003926841542124748, 0.01656133122742176, 0.005921937059611082, -0.017525387927889824, -0.015063539147377014, 0.01610901765525341, -0.02107916958630085, -0.03472943603992462, 0.0004940861836075783, -0.0025399732403457165, -0.010648032650351524, 0.018816571682691574, -0.0013127221027389169, 0.002739502349868417, 0.010874373838305473, 0.009477074258029461, 0.029348108917474747, -0.009879866614937782, 0.0006510575185529888, -0.0345064178109169, -0.027261750772595406, -0.020388009026646614, 0.021728867664933205, 0.00908044446259737, -0.0026765097863972187, -0.0013476130552589893, -0.021931884810328484, 0.004504455719143152, -0.002877801191061735, -0.021071096882224083, -0.025016184896230698, 0.013300277292728424, 0.033753231167793274, 0.0033556174021214247, -0.008366292342543602, -0.0022860164754092693, -0.015286003239452839, 0.013441064395010471, -0.007800496183335781, -0.002339616185054183, 0.02338201366364956, -0.005388267338275909, -0.006158708594739437, -0.008452006615698338, 0.013910813257098198, -0.009527708403766155, -0.007435370236635208, -0.019391553476452827, -0.037568625062704086, -0.029532471671700478, 0.01903286762535572, 0.019490333274006844, -0.020690176635980606, 0.020966921001672745, -0.02908112108707428, -0.045168787240982056, -0.019703354686498642, 0.008466202765703201, 0.02124989964067936, -0.004516279324889183, 0.005193468648940325, 0.01626325026154518, -0.011250928975641727, -0.010766512714326382, 0.03141772747039795, 0.004785836208611727, 0.017450058832764626, -0.023900507017970085, 0.0029408810660243034, 0.009686837904155254, 0.008507897146046162, 0.010248901322484016, -0.00968305766582489, -0.03584464639425278, 0.01119953766465187, 0.009718997403979301, -0.020481042563915253, -0.02450455166399479, -0.016856862232089043, -0.012904630042612553, -0.026028236374258995, -0.017150865867733955, -0.012346465140581131, -0.018532371148467064, 0.025859693065285683, 0.001642965478822589, 0.0029566024895757437, -0.011198898777365685, 0.009346007369458675, 0.01664908230304718, -0.007854904979467392, 0.0017561519052833319, -0.005874312482774258, 0.01247441116720438, 0.027933394536376, 0.014959543012082577, -0.0035759105812758207, 0.010582095943391323, -0.017762726172804832, -0.021257108077406883, -0.01733403280377388, -0.033713195472955704, -0.02241545170545578, -0.0324193611741066, -0.017299950122833252, -0.01931961067020893, 0.02767017111182213, 0.007836246863007545, -0.0031448728404939175, -0.012432815507054329, 0.018722034990787506, 0.004943827632814646, 0.008611618541181087, 0.007714110892266035, 0.013966700993478298, -0.026626799255609512, -0.004178838338702917, -0.040977537631988525, -0.037444986402988434, -0.02501726895570755, -0.012337730266153812, -0.0007019097683951259, -0.019960474222898483, -0.03076227568089962, -0.006531404796987772, 0.0353948175907135, -0.020159045234322548, 0.015511779114603996, -0.01839650422334671, -0.015417857095599174, 0.006898731458932161, -0.0013957797782495618, -0.00861312821507454, 0.0048472401686012745, -0.006989577319473028, 0.014293970540165901, -0.001995841972529888, 0.0012099843006581068, -0.011417980305850506, -0.010824204422533512, 0.005548582412302494, 0.008086569607257843, 0.030561508610844612, -0.024062298238277435, -0.010223119519650936, -0.01909988932311535, -0.02895381860435009, 0.008869112469255924, -0.0038235951215028763, 0.016732225194573402, -0.0031617649365216494, -0.054160553961992264, -0.0066643282771110535, -0.012081420980393887, 0.04048002511262894, -0.002691210014745593, -0.005627869628369808, -0.008520402014255524, 0.01003995444625616, 0.0057471198961138725, 0.02283681370317936, 0.015072538517415524, -0.03315580263733864, -0.03710092976689339, 0.023909425362944603, -0.015751969069242477, -0.03254316747188568, -0.013684866949915886, 0.01973065547645092, -0.011026754043996334, -0.006654615048319101, -0.03934592381119728, -0.005349415820091963, -0.003344267141073942, -0.020048044621944427, 0.0013933200389146805, 0.0024088823702186346, -0.021591700613498688, 0.00613724859431386, -0.0070800757966935635, -0.04042505472898483, 0.019745340570807457, 0.016338719055056572, -0.024095192551612854, -0.0064626350067555904, 0.015428487211465836, 0.007606758736073971, 0.0015156216686591506, -0.008836660534143448, -0.017967427149415016, 0.004886816255748272, -0.003482478205114603, -0.004152418114244938, -0.03537209704518318, 0.0056213270872831345, 0.010049271397292614, -0.010824550874531269, -0.0007081387448124588, -0.033267632126808167, 0.003877865383401513, 0.014899319969117641, 0.014063564129173756, 0.0253905076533556, -0.005851639900356531, -0.0274688508361578, 0.007298024371266365, -0.030892694368958473, 0.0059909513220191, -0.04152733087539673, 0.0330117829144001, -0.019173739477992058, -0.012793712317943573, -0.018074510619044304, -0.004863292444497347, -0.034328050911426544, 0.014984448440372944, 0.017666662111878395, 0.0026483130641281605, 0.009673068299889565, -0.01944250799715519, 0.0178897175937891, 0.0023168628104031086, 0.007169119082391262, -0.02814623899757862, 0.012051381170749664, 0.0052552190609276295, -0.02003522962331772, -0.007957889698445797, 0.004778067581355572, -0.006217727437615395, 0.025331148877739906, 0.031082604080438614, -0.00866988580673933, -0.0028622751124203205, 0.008811399340629578, 0.025644859299063683, 0.008227955549955368, 0.018399197608232498, -0.018623696640133858, -0.013590935617685318, 0.0025785600300878286, -0.0005955387023277581, -0.0070097497664391994, -0.026952343061566353, 0.025513596832752228, -0.016439277678728104, 0.0015186150558292866, 0.022172948345541954, -0.031375009566545486, -0.00909152440726757, -0.03475676849484444, 0.02117505669593811, 0.03501884639263153, 0.0021872420329600573, -0.009306172840297222, 0.0050252447836101055, -0.008301046676933765, -0.017009317874908447, -0.01876923069357872, -0.041560228914022446, -0.023617539554834366, -0.02223452739417553, -0.0010081889340654016, -0.01844184100627899, -0.02119215577840805, -0.003648810088634491, -0.005869364365935326, 0.026415010914206505, 0.014734534546732903, -0.031962137669324875, -0.024516358971595764, 0.015216417610645294, 0.016993960365653038, -0.019925132393836975, -0.012865212745964527, -0.02248411998152733, 0.021056216210126877, 0.013907753862440586, 0.017418982461094856, -0.011928195133805275, 0.014555665664374828, -0.006378880701959133, 0.020310912281274796, 0.020983291789889336, -0.030845824629068375, -0.048152580857276917, -0.02284562774002552, -0.012554306536912918, -0.003612141590565443, 0.00025040676700882614, -0.025794288143515587, 0.02579488977789879, -0.03530524671077728, -0.011757716536521912, 0.035354986786842346, 0.01269700936973095, 0.016071245074272156, 0.017089689150452614, -0.019521934911608696, -0.0044438340701162815, -0.02098369225859642, -0.004990286193788052, 0.025788284838199615, 0.010853523388504982, -0.04105585813522339, 0.026173776015639305, 0.003607070306316018, 0.002694803522899747, -0.01817702129483223, -0.02878315933048725, 0.03184919431805611, -0.006316084880381823, 0.004923338536173105, 0.020674580708146095, -0.014955699443817139, -0.005266997963190079, -0.025481482967734337, 0.013926343992352486, 0.014503325335681438, 0.014867433346807957, -0.015581502579152584, -0.0039225053042173386, -0.04077142849564552, -0.0255319494754076, 0.009605235420167446, -0.0016728687332943082, 0.017874523997306824, 0.012330427765846252, 0.0019038096070289612, -0.010533805005252361, -0.010004810057580471, -0.018896421417593956, -0.015789832919836044, -0.0018506583292037249, -0.01665160432457924, 0.008904189802706242, -0.017686238512396812, -0.00302766147069633, -0.03126286342740059, -0.017054786905646324, 0.031484901905059814, -0.014395579695701599, 0.002508192090317607, -0.005969790741801262, -0.005768124479800463, 0.0031455494463443756, 0.004740079399198294, 0.01708989217877388, -0.01044031884521246, 0.004626424051821232, -0.008325009606778622, -0.023496663197875023, -0.01510787196457386, -0.01579173095524311, -0.01412075012922287, -0.004547642543911934, -0.054232675582170486, 0.007421308197081089, -0.014511529356241226, 0.008946605958044529, 0.012683620676398277, 0.004097502678632736, -0.011134603060781956, 0.008752654306590557, -0.019791962578892708, -0.015490262769162655, 0.03514929860830307, -0.00995893869549036, 0.010088869370520115, -0.024163953959941864, -0.0037897969596087933, -0.0004652949282899499, -0.009280034340918064, 0.0063949692994356155, -0.009696239605545998, -0.009278526529669762, -0.007485891226679087, 0.010607821866869926, 0.008253930136561394, -0.030286923050880432, -0.04081008955836296, -0.0008356155594810843, 0.010592452250421047, -0.02562306821346283, -0.021696262061595917, 0.024924548342823982, -0.00673980638384819, 0.0024230799172073603, -0.027382342144846916, 0.013549506664276123, 0.016838280484080315, -0.008071132935583591, -0.01511723455041647, 0.025759007781744003, -0.013094299472868443, 0.03078872337937355, -0.0008567335898987949, 0.031734492629766464, -0.03288773447275162, -0.01712125726044178, 0.02995210327208042, 0.017738278955221176, 0.01045806985348463, -0.0003981536137871444, 0.011633502319455147, -0.007574515882879496, 0.02462957426905632, 0.006079091224819422, -0.0052962880581617355, -0.01572585292160511, -0.04218913987278938, -0.03827909380197525, 0.0026710208039730787, -0.017788801342248917, -0.009716718457639217, -0.009913788177073002, 0.007922687567770481, 0.020568963140249252, 0.02276216261088848, -0.003592813853174448, 0.00452218484133482, 0.003644688054919243, 0.04029596969485283, 0.0031954750884324312, -0.038406528532505035, -0.01885879784822464, -0.017342528328299522, 0.03334946557879448, 0.00010742628364823759, 0.01186453178524971, -0.018045997247099876, -0.0032756372820585966, -0.00998181663453579, -0.03491273522377014, -0.01180063746869564, -0.023135656490921974, 0.01810188964009285, 0.006640571169555187, 0.009781504049897194, -0.016485633328557014, 0.030663983896374702, 0.014669165015220642, 0.019700318574905396, 0.016755856573581696, 0.007913288660347462, -0.03501228988170624, 0.004900692496448755, 0.013959177769720554, -0.004512800369411707, -0.006015898194164038, 0.017686448991298676, 0.00970732606947422, 0.03294210508465767, -0.0034140190109610558, -0.022699711844325066, 0.0074545168317854404, 0.002418610965833068, 0.012200153432786465, -0.01697917841374874, -0.03565932810306549, 0.02378905937075615, -0.01522363442927599, -0.019644852727651596, 0.0505535714328289, -0.0172421857714653, 0.0032309312373399734, -0.00072035490302369, -0.0010433699935674667, 0.01811853237450123, 0.01587279886007309, 0.013627699576318264, 0.02413749136030674, -0.019949378445744514, 0.013955682516098022, 0.002325328066945076, 0.009488007053732872, -0.017068615183234215, -0.04162387177348137, 0.005385233089327812, 0.01171999890357256, -0.004920112434774637, -0.0065228561870753765, 0.006596772465854883, 0.030484432354569435, 0.013942062854766846, -0.018828803673386574, -0.008438545279204845, 0.026894688606262207, -0.010651185177266598, -0.02161748893558979, -0.02744552306830883, -0.01727581024169922, -0.010156466625630856, 0.007622660603374243, -0.013895892538130283, 0.031135400757193565, -0.00243721017614007, -0.010445529595017433, 0.0030529515352100134, -0.021901661530137062, -0.012888963334262371, -0.0046780831180512905, -0.001432187738828361, -0.022995470091700554, -0.01770775392651558, -0.027859706431627274, 0.017050396651029587, 0.002758940914645791, -0.028347767889499664, 0.015545963309705257, -0.03008543699979782, 0.007181043270975351, 0.01380420196801424, -0.016461266204714775, -0.01490688044577837, 0.007780466228723526, -0.001885504461824894, 0.0013568021822720766, -0.024402309209108353, -0.01821504347026348, 0.014201277866959572, 0.0053913225419819355, -0.0394306480884552, -0.040167778730392456, -0.012743144296109676, -0.016374826431274414, -0.0023999910335987806, 0.016947772353887558, -0.022667327895760536, -0.0018928530625998974, 0.005565367639064789, 0.01491745375096798, -0.013951235450804234, 0.001513186958618462, -0.00477558234706521, -0.0031340536661446095, -0.018357908353209496, 0.007457357831299305, -0.027503417804837227, -0.003321420168504119, 0.007307516876608133, 0.0010208053281530738, 0.02738717570900917, 0.002226191572844982, 0.027198076248168945, -0.004863386042416096, -0.0107851168140769, 0.03295987471938133, -0.01731731742620468, -0.030677925795316696, 0.006163361016660929, 0.0007902036304585636, 0.010304510593414307, 0.003345437115058303, -0.0013166331918910146, 0.00427712919190526, -0.004310079850256443, 0.0035202086437493563, -0.004697876516729593, -0.00919288769364357, -0.00042457153904251754, 0.004992994945496321, 0.014708831906318665, -0.0030492693185806274, 0.005161716137081385, 0.0004297721025068313, -0.0047897337935864925, 0.005775022320449352, -0.0019442603224888444, -0.007232870906591415, 0.02022389881312847, -0.03642120212316513]') as si FROM ucr_chan_model.kn_inst_base b , ucr_chan_model.kn_inst_embedding e where b.kn_id = e.kn_id and  e.embedding_type in ('3','4') limit 100 ";
        sql = "SELECT b.kn_id, b.task_id, b.title, b.docdescribe,b.tmpl_id ,b.tmpl_name, b.kn_key_words, b.kn_catalog, b.kn_source, b.kn_area_name, b.kn_role_name, b.kn_base,b.area_cmetadata,b.role_cmetadata,  b.oss_id, b.valid_date, b.expire_date, b.state, b.create_time, b.create_op_name, b.update_time, b.update_op_name, b.remark, b.ext1, b.ext2,  1 - (e.embedding <=> '[0.0037139414343982935, -0.03436264768242836, -0.02966061607003212, 0.04305531084537506, -0.003602546639740467, -0.0011795238824561238, -0.014307397417724133, -0.023669380694627762, 0.02146964892745018, 0.0073777614161372185, 0.01237974688410759, 0.01936524361371994, 0.013516908511519432, -0.00527459429576993, -0.006383276078850031, 0.00531381368637085, 0.004246037919074297, 0.0009906258201226592, -0.018573489040136337, -0.00885749515146017, 0.013009998016059399, 0.020815227180719376, -0.014867777936160564, -0.019281158223748207, 0.02689504064619541, -0.01609490066766739, -0.0037939059548079967, 0.008793685585260391, 0.023236699402332306, -0.013612143695354462, -0.03500877693295479, 0.011001761071383953, 0.020369762554764748, 0.018333937972784042, 0.0012100983876734972, 0.0010137376375496387, -0.02304876036942005, 0.016862109303474426, 0.003914439585059881, -0.012534502893686295, 0.0038604228757321835, -0.006910305470228195, -0.0047537642531096935, -0.03134701028466225, 0.019436819478869438, -0.008714222349226475, -0.018467534333467484, -0.057900529354810715, -9.148109529633075e-05, -0.0116786640137434, 0.013053356669843197, -0.020974602550268173, -0.013152575120329857, 0.024304507300257683, -0.01351625844836235, -0.005117361433804035, 0.0022367825731635094, -0.010944691486656666, -0.020543880760669708, -0.007644811179488897, 0.016901299357414246, 0.17239253222942352, 0.004441042896360159, 0.015566851943731308, 0.02045804262161255, -0.006166150793433189, 0.008502457290887833, 0.005853051785379648, -0.020686183124780655, 0.004610423929989338, 0.0017266077920794487, 0.027679748833179474, 0.011952312663197517, 0.002717118477448821, 0.021232014521956444, -0.002375425072386861, -0.026090454310178757, 0.009733021259307861, -0.011447963304817677, -0.015014725737273693, -0.019494792446494102, 0.01973753422498703, 0.024340244010090828, -0.01708824560046196, 0.01920127309858799, -0.008231948129832745, 0.018733637407422066, 0.7593673467636108, -0.011248799040913582, 0.02662489004433155, 0.01288904994726181, -0.011232160963118076, -0.013847434893250465, 0.008915543556213379, -0.013532853685319424, 0.011959630064666271, -0.01670019142329693, -0.0038313698023557663, 0.007408248260617256, 0.017124047502875328, 0.0211978517472744, -0.0083115603774786, -0.013413539156317711, -0.013240132480859756, -0.02210293710231781, 0.0046822139993309975, -0.03728945925831795, -0.03735770657658577, -0.018171949312090874, 0.0031544219236820936, 0.016408391296863556, -0.036513350903987885, -0.03645212575793266, -0.010924430564045906, 0.008413080126047134, -0.009044083766639233, 0.006938362494111061, 0.021885152906179428, 0.02457335777580738, 0.01782977394759655, -0.012999697588384151, 0.044865675270557404, 0.0022276246454566717, -0.027451341971755028, 0.0034144995734095573, -0.0065081799402832985, -0.01705850474536419, -0.013570183888077736, 0.0006270731100812554, 0.006574538070708513, 0.0009102543699555099, -0.023422274738550186, -0.005480686668306589, 0.004174100235104561, -0.010539856739342213, 0.012988430447876453, 0.002140151569619775, 0.01429405715316534, -0.005388389807194471, 0.0008274659630842507, 0.020656853914260864, -0.028582215309143066, 0.016603758558630943, -0.032374314963817596, 0.01697026938199997, -0.023283975198864937, -0.0017912163166329265, 0.013584756292402744, 0.014126809313893318, -0.016035480424761772, 0.023854190483689308, -0.027339095249772072, -0.009655185043811798, -0.007034513633698225, 0.0037103467620909214, 0.0021849970798939466, -0.0077376896515488625, -0.0220235176384449, 0.01669670268893242, -0.005191444884985685, 0.010149051435291767, -0.0014942832058295608, 0.016808241605758667, -0.0367431677877903, -0.0007391397375613451, -0.019050275906920433, 0.019481537863612175, -0.017752550542354584, 0.009034591726958752, 0.029077695682644844, -0.025102566927671432, 0.015337828546762466, 0.0045476951636374, 0.027813365682959557, 0.0346677228808403, -0.019748127087950706, -0.004769799765199423, 0.004644186235964298, -4.78739311802201e-05, -0.0030333464965224266, 0.020133808255195618, 0.02101719006896019, 0.020643452182412148, -0.03833789378404617, -0.012603308074176311, 0.03398535028100014, 0.007660923060029745, -0.0011099977418780327, -0.02474784478545189, -0.023068053647875786, 0.004623538348823786, 0.027570035308599472, 0.01997419074177742, -0.01716763526201248, -0.006944598630070686, -0.014973876066505909, -0.006677018478512764, -0.007421072106808424, 0.006137261167168617, 0.010737969540059566, -0.020192498341202736, 0.03176166117191315, 0.01333872601389885, 0.014156552031636238, 0.013494077138602734, -0.0030087183695286512, 0.029728922992944717, 0.003641825634986162, 0.02283678948879242, 0.019149543717503548, -0.0309207271784544, -0.002178614493459463, 0.03344530984759331, 0.011518510058522224, -0.023436985909938812, 0.020069772377610207, -0.014226620085537434, 8.517536480212584e-05, 0.012778679840266705, 0.014645321294665337, 0.014953126199543476, 0.002747401362285018, -0.022479476407170296, -0.0036022081039845943, 0.003113372949883342, 0.009968406520783901, 0.014330258592963219, 0.007661798968911171, -0.007286549545824528, 0.004847601987421513, -0.03274970501661301, -0.016528593376278877, -0.01123441755771637, -0.009488876909017563, -0.0019530949648469687, 0.011941524222493172, 0.0020462842658162117, -0.0019390969537198544, -0.05111432448029518, -0.011299503967165947, -0.012909987010061741, 0.0147582171484828, -0.005957773886620998, -0.01688549853861332, 0.0026521170511841774, 0.0015704234829172492, 0.010435481555759907, 0.02762077935039997, 0.0034809885546565056, -0.0036488336045295, -0.012177564203739166, -0.013935405761003494, 0.014253775589168072, -0.04330558329820633, 0.013064512982964516, -0.041493598371744156, -0.005979438778012991, -0.025497937574982643, 0.015067611820995808, -0.0021771083120256662, 0.031093550845980644, -0.02788807451725006, 0.012067084200680256, -0.012952744960784912, 0.00031783906160853803, 0.0007678014226257801, 0.006133107468485832, 0.008367099799215794, -0.0002269435062771663, -0.036493901163339615, 0.0010753432288765907, 0.012001780793070793, -0.0002042134292423725, -0.018107445910573006, 0.004324367735534906, 0.028720472007989883, -0.012264573946595192, 0.012357023544609547, 0.008217781782150269, -0.016072051599621773, -0.020087765529751778, 0.011101256124675274, -0.04118366539478302, 0.01885484717786312, 0.006412389688193798, 0.001459332648664713, -0.0042141396552324295, -0.018381696194410324, 0.0019496828317642212, 0.014373530633747578, -0.025235090404748917, -0.00501938397064805, 0.008859102614223957, -0.011533226817846298, 0.004717379808425903, 0.028251122683286667, 0.027819108217954636, 0.013209613040089607, -0.011161896400153637, -0.015020591206848621, 0.015485105104744434, -0.016314731910824776, 0.005155379418283701, 0.00790813472121954, -0.011961241252720356, 0.02150120958685875, -0.02265853062272072, 0.019509028643369675, -0.008726163767278194, 0.00968693196773529, -0.030582888051867485, -0.02921181172132492, 0.013566294685006142, -0.020525377243757248, 0.006739228963851929, -0.01047747116535902, 0.018860166892409325, -0.004518131725490093, -0.04288051277399063, 0.010269618593156338, 0.005020788870751858, -0.014356502331793308, -0.03229595720767975, -0.048904210329055786, 0.01541735790669918, 0.04704589024186134, 0.0069441646337509155, -0.0039440966211259365, -0.0205170176923275, 0.007100281305611134, 0.004596219398081303, 0.012221149168908596, -0.007326704915612936, -0.010255290195345879, -0.013410321436822414, 0.0068300277926027775, 0.03553367033600807, 0.004971387330442667, -0.01651221327483654, 0.03785407915711403, 0.014801791869103909, -0.005595675203949213, 0.0069172075018286705, -0.057068485766649246, 0.01145403366535902, 0.008377527818083763, 0.0028310022316873074, 0.02033447101712227, 0.004505581222474575, 0.000924202729947865, 0.01614631898701191, 0.030125129967927933, 0.03181018307805061, -0.00852222554385662, 0.03316326439380646, -0.02378140203654766, -0.0355704203248024, 0.007859507575631142, 0.004217175766825676, 0.0007126841228455305, -0.017102224752306938, 0.03044300153851509, 0.00835470948368311, -0.0031076944433152676, -0.0030577112920582294, -0.025321979075670242, -0.018706053495407104, 0.009885616600513458, -0.020197348669171333, -0.03134474158287048, 0.021558813750743866, 0.013969123363494873, 0.01753544993698597, -0.02845025435090065, 0.020756583660840988, -0.02399986796081066, -0.002361591439694166, -0.012933047488331795, 0.027323096990585327, 0.015429206192493439, -0.011593486182391644, 0.017147352918982506, 0.0002323748922208324, 0.007722292095422745, 0.00511829974129796, -0.00885489210486412, -0.011711448431015015, 0.020393984392285347, -0.013619478791952133, -0.014759364537894726, 0.004640297498553991, -0.03407832607626915, 0.006830506958067417, 0.0010727726621553302, -0.014944612979888916, 0.022166850045323372, 0.0033194900024682283, 0.019606437534093857, -0.015066378749907017, 0.0383845753967762, -0.01234683208167553, -0.007121261674910784, -0.0025356553960591555, -0.2037884145975113, 0.024143528193235397, -0.002494484419003129, 0.017837312072515488, 0.010273115709424019, -0.006298561580479145, 0.022909801453351974, -0.020997289568185806, -0.047127705067396164, -0.03315228968858719, -0.0026174362283200026, -0.005597913637757301, -0.005702924448996782, -0.03079543448984623, 0.008120181038975716, 0.012594151310622692, 0.010291407816112041, 0.024613020941615105, -0.010859732516109943, -0.0031454151030629873, -0.006644688080996275, 0.005056783091276884, -0.009945191442966461, 0.0020006136037409306, -0.008362575434148312, -0.020065708085894585, -0.006310971453785896, 0.004227867815643549, -0.004387402441352606, -0.01292747724801302, -0.0022352063097059727, 0.02950243465602398, -0.029811525717377663, -0.03617876395583153, -0.017740894109010696, -0.03123101033270359, -0.030716994777321815, 0.011749310418963432, 0.02629806101322174, -0.005376407410949469, -0.0024725201074033976, -0.031514473259449005, -0.005028721410781145, -0.01800159551203251, -0.035628486424684525, -0.011336443945765495, -0.048255935311317444, -0.00024036980175878853, -0.014190949499607086, 0.003926841542124748, 0.01656133122742176, 0.005921937059611082, -0.017525387927889824, -0.015063539147377014, 0.01610901765525341, -0.02107916958630085, -0.03472943603992462, 0.0004940861836075783, -0.0025399732403457165, -0.010648032650351524, 0.018816571682691574, -0.0013127221027389169, 0.002739502349868417, 0.010874373838305473, 0.009477074258029461, 0.029348108917474747, -0.009879866614937782, 0.0006510575185529888, -0.0345064178109169, -0.027261750772595406, -0.020388009026646614, 0.021728867664933205, 0.00908044446259737, -0.0026765097863972187, -0.0013476130552589893, -0.021931884810328484, 0.004504455719143152, -0.002877801191061735, -0.021071096882224083, -0.025016184896230698, 0.013300277292728424, 0.033753231167793274, 0.0033556174021214247, -0.008366292342543602, -0.0022860164754092693, -0.015286003239452839, 0.013441064395010471, -0.007800496183335781, -0.002339616185054183, 0.02338201366364956, -0.005388267338275909, -0.006158708594739437, -0.008452006615698338, 0.013910813257098198, -0.009527708403766155, -0.007435370236635208, -0.019391553476452827, -0.037568625062704086, -0.029532471671700478, 0.01903286762535572, 0.019490333274006844, -0.020690176635980606, 0.020966921001672745, -0.02908112108707428, -0.045168787240982056, -0.019703354686498642, 0.008466202765703201, 0.02124989964067936, -0.004516279324889183, 0.005193468648940325, 0.01626325026154518, -0.011250928975641727, -0.010766512714326382, 0.03141772747039795, 0.004785836208611727, 0.017450058832764626, -0.023900507017970085, 0.0029408810660243034, 0.009686837904155254, 0.008507897146046162, 0.010248901322484016, -0.00968305766582489, -0.03584464639425278, 0.01119953766465187, 0.009718997403979301, -0.020481042563915253, -0.02450455166399479, -0.016856862232089043, -0.012904630042612553, -0.026028236374258995, -0.017150865867733955, -0.012346465140581131, -0.018532371148467064, 0.025859693065285683, 0.001642965478822589, 0.0029566024895757437, -0.011198898777365685, 0.009346007369458675, 0.01664908230304718, -0.007854904979467392, 0.0017561519052833319, -0.005874312482774258, 0.01247441116720438, 0.027933394536376, 0.014959543012082577, -0.0035759105812758207, 0.010582095943391323, -0.017762726172804832, -0.021257108077406883, -0.01733403280377388, -0.033713195472955704, -0.02241545170545578, -0.0324193611741066, -0.017299950122833252, -0.01931961067020893, 0.02767017111182213, 0.007836246863007545, -0.0031448728404939175, -0.012432815507054329, 0.018722034990787506, 0.004943827632814646, 0.008611618541181087, 0.007714110892266035, 0.013966700993478298, -0.026626799255609512, -0.004178838338702917, -0.040977537631988525, -0.037444986402988434, -0.02501726895570755, -0.012337730266153812, -0.0007019097683951259, -0.019960474222898483, -0.03076227568089962, -0.006531404796987772, 0.0353948175907135, -0.020159045234322548, 0.015511779114603996, -0.01839650422334671, -0.015417857095599174, 0.006898731458932161, -0.0013957797782495618, -0.00861312821507454, 0.0048472401686012745, -0.006989577319473028, 0.014293970540165901, -0.001995841972529888, 0.0012099843006581068, -0.011417980305850506, -0.010824204422533512, 0.005548582412302494, 0.008086569607257843, 0.030561508610844612, -0.024062298238277435, -0.010223119519650936, -0.01909988932311535, -0.02895381860435009, 0.008869112469255924, -0.0038235951215028763, 0.016732225194573402, -0.0031617649365216494, -0.054160553961992264, -0.0066643282771110535, -0.012081420980393887, 0.04048002511262894, -0.002691210014745593, -0.005627869628369808, -0.008520402014255524, 0.01003995444625616, 0.0057471198961138725, 0.02283681370317936, 0.015072538517415524, -0.03315580263733864, -0.03710092976689339, 0.023909425362944603, -0.015751969069242477, -0.03254316747188568, -0.013684866949915886, 0.01973065547645092, -0.011026754043996334, -0.006654615048319101, -0.03934592381119728, -0.005349415820091963, -0.003344267141073942, -0.020048044621944427, 0.0013933200389146805, 0.0024088823702186346, -0.021591700613498688, 0.00613724859431386, -0.0070800757966935635, -0.04042505472898483, 0.019745340570807457, 0.016338719055056572, -0.024095192551612854, -0.0064626350067555904, 0.015428487211465836, 0.007606758736073971, 0.0015156216686591506, -0.008836660534143448, -0.017967427149415016, 0.004886816255748272, -0.003482478205114603, -0.004152418114244938, -0.03537209704518318, 0.0056213270872831345, 0.010049271397292614, -0.010824550874531269, -0.0007081387448124588, -0.033267632126808167, 0.003877865383401513, 0.014899319969117641, 0.014063564129173756, 0.0253905076533556, -0.005851639900356531, -0.0274688508361578, 0.007298024371266365, -0.030892694368958473, 0.0059909513220191, -0.04152733087539673, 0.0330117829144001, -0.019173739477992058, -0.012793712317943573, -0.018074510619044304, -0.004863292444497347, -0.034328050911426544, 0.014984448440372944, 0.017666662111878395, 0.0026483130641281605, 0.009673068299889565, -0.01944250799715519, 0.0178897175937891, 0.0023168628104031086, 0.007169119082391262, -0.02814623899757862, 0.012051381170749664, 0.0052552190609276295, -0.02003522962331772, -0.007957889698445797, 0.004778067581355572, -0.006217727437615395, 0.025331148877739906, 0.031082604080438614, -0.00866988580673933, -0.0028622751124203205, 0.008811399340629578, 0.025644859299063683, 0.008227955549955368, 0.018399197608232498, -0.018623696640133858, -0.013590935617685318, 0.0025785600300878286, -0.0005955387023277581, -0.0070097497664391994, -0.026952343061566353, 0.025513596832752228, -0.016439277678728104, 0.0015186150558292866, 0.022172948345541954, -0.031375009566545486, -0.00909152440726757, -0.03475676849484444, 0.02117505669593811, 0.03501884639263153, 0.0021872420329600573, -0.009306172840297222, 0.0050252447836101055, -0.008301046676933765, -0.017009317874908447, -0.01876923069357872, -0.041560228914022446, -0.023617539554834366, -0.02223452739417553, -0.0010081889340654016, -0.01844184100627899, -0.02119215577840805, -0.003648810088634491, -0.005869364365935326, 0.026415010914206505, 0.014734534546732903, -0.031962137669324875, -0.024516358971595764, 0.015216417610645294, 0.016993960365653038, -0.019925132393836975, -0.012865212745964527, -0.02248411998152733, 0.021056216210126877, 0.013907753862440586, 0.017418982461094856, -0.011928195133805275, 0.014555665664374828, -0.006378880701959133, 0.020310912281274796, 0.020983291789889336, -0.030845824629068375, -0.048152580857276917, -0.02284562774002552, -0.012554306536912918, -0.003612141590565443, 0.00025040676700882614, -0.025794288143515587, 0.02579488977789879, -0.03530524671077728, -0.011757716536521912, 0.035354986786842346, 0.01269700936973095, 0.016071245074272156, 0.017089689150452614, -0.019521934911608696, -0.0044438340701162815, -0.02098369225859642, -0.004990286193788052, 0.025788284838199615, 0.010853523388504982, -0.04105585813522339, 0.026173776015639305, 0.003607070306316018, 0.002694803522899747, -0.01817702129483223, -0.02878315933048725, 0.03184919431805611, -0.006316084880381823, 0.004923338536173105, 0.020674580708146095, -0.014955699443817139, -0.005266997963190079, -0.025481482967734337, 0.013926343992352486, 0.014503325335681438, 0.014867433346807957, -0.015581502579152584, -0.0039225053042173386, -0.04077142849564552, -0.0255319494754076, 0.009605235420167446, -0.0016728687332943082, 0.017874523997306824, 0.012330427765846252, 0.0019038096070289612, -0.010533805005252361, -0.010004810057580471, -0.018896421417593956, -0.015789832919836044, -0.0018506583292037249, -0.01665160432457924, 0.008904189802706242, -0.017686238512396812, -0.00302766147069633, -0.03126286342740059, -0.017054786905646324, 0.031484901905059814, -0.014395579695701599, 0.002508192090317607, -0.005969790741801262, -0.005768124479800463, 0.0031455494463443756, 0.004740079399198294, 0.01708989217877388, -0.01044031884521246, 0.004626424051821232, -0.008325009606778622, -0.023496663197875023, -0.01510787196457386, -0.01579173095524311, -0.01412075012922287, -0.004547642543911934, -0.054232675582170486, 0.007421308197081089, -0.014511529356241226, 0.008946605958044529, 0.012683620676398277, 0.004097502678632736, -0.011134603060781956, 0.008752654306590557, -0.019791962578892708, -0.015490262769162655, 0.03514929860830307, -0.00995893869549036, 0.010088869370520115, -0.024163953959941864, -0.0037897969596087933, -0.0004652949282899499, -0.009280034340918064, 0.0063949692994356155, -0.009696239605545998, -0.009278526529669762, -0.007485891226679087, 0.010607821866869926, 0.008253930136561394, -0.030286923050880432, -0.04081008955836296, -0.0008356155594810843, 0.010592452250421047, -0.02562306821346283, -0.021696262061595917, 0.024924548342823982, -0.00673980638384819, 0.0024230799172073603, -0.027382342144846916, 0.013549506664276123, 0.016838280484080315, -0.008071132935583591, -0.01511723455041647, 0.025759007781744003, -0.013094299472868443, 0.03078872337937355, -0.0008567335898987949, 0.031734492629766464, -0.03288773447275162, -0.01712125726044178, 0.02995210327208042, 0.017738278955221176, 0.01045806985348463, -0.0003981536137871444, 0.011633502319455147, -0.007574515882879496, 0.02462957426905632, 0.006079091224819422, -0.0052962880581617355, -0.01572585292160511, -0.04218913987278938, -0.03827909380197525, 0.0026710208039730787, -0.017788801342248917, -0.009716718457639217, -0.009913788177073002, 0.007922687567770481, 0.020568963140249252, 0.02276216261088848, -0.003592813853174448, 0.00452218484133482, 0.003644688054919243, 0.04029596969485283, 0.0031954750884324312, -0.038406528532505035, -0.01885879784822464, -0.017342528328299522, 0.03334946557879448, 0.00010742628364823759, 0.01186453178524971, -0.018045997247099876, -0.0032756372820585966, -0.00998181663453579, -0.03491273522377014, -0.01180063746869564, -0.023135656490921974, 0.01810188964009285, 0.006640571169555187, 0.009781504049897194, -0.016485633328557014, 0.030663983896374702, 0.014669165015220642, 0.019700318574905396, 0.016755856573581696, 0.007913288660347462, -0.03501228988170624, 0.004900692496448755, 0.013959177769720554, -0.004512800369411707, -0.006015898194164038, 0.017686448991298676, 0.00970732606947422, 0.03294210508465767, -0.0034140190109610558, -0.022699711844325066, 0.0074545168317854404, 0.002418610965833068, 0.012200153432786465, -0.01697917841374874, -0.03565932810306549, 0.02378905937075615, -0.01522363442927599, -0.019644852727651596, 0.0505535714328289, -0.0172421857714653, 0.0032309312373399734, -0.00072035490302369, -0.0010433699935674667, 0.01811853237450123, 0.01587279886007309, 0.013627699576318264, 0.02413749136030674, -0.019949378445744514, 0.013955682516098022, 0.002325328066945076, 0.009488007053732872, -0.017068615183234215, -0.04162387177348137, 0.005385233089327812, 0.01171999890357256, -0.004920112434774637, -0.0065228561870753765, 0.006596772465854883, 0.030484432354569435, 0.013942062854766846, -0.018828803673386574, -0.008438545279204845, 0.026894688606262207, -0.010651185177266598, -0.02161748893558979, -0.02744552306830883, -0.01727581024169922, -0.010156466625630856, 0.007622660603374243, -0.013895892538130283, 0.031135400757193565, -0.00243721017614007, -0.010445529595017433, 0.0030529515352100134, -0.021901661530137062, -0.012888963334262371, -0.0046780831180512905, -0.001432187738828361, -0.022995470091700554, -0.01770775392651558, -0.027859706431627274, 0.017050396651029587, 0.002758940914645791, -0.028347767889499664, 0.015545963309705257, -0.03008543699979782, 0.007181043270975351, 0.01380420196801424, -0.016461266204714775, -0.01490688044577837, 0.007780466228723526, -0.001885504461824894, 0.0013568021822720766, -0.024402309209108353, -0.01821504347026348, 0.014201277866959572, 0.0053913225419819355, -0.0394306480884552, -0.040167778730392456, -0.012743144296109676, -0.016374826431274414, -0.0023999910335987806, 0.016947772353887558, -0.022667327895760536, -0.0018928530625998974, 0.005565367639064789, 0.01491745375096798, -0.013951235450804234, 0.001513186958618462, -0.00477558234706521, -0.0031340536661446095, -0.018357908353209496, 0.007457357831299305, -0.027503417804837227, -0.003321420168504119, 0.007307516876608133, 0.0010208053281530738, 0.02738717570900917, 0.002226191572844982, 0.027198076248168945, -0.004863386042416096, -0.0107851168140769, 0.03295987471938133, -0.01731731742620468, -0.030677925795316696, 0.006163361016660929, 0.0007902036304585636, 0.010304510593414307, 0.003345437115058303, -0.0013166331918910146, 0.00427712919190526, -0.004310079850256443, 0.0035202086437493563, -0.004697876516729593, -0.00919288769364357, -0.00042457153904251754, 0.004992994945496321, 0.014708831906318665, -0.0030492693185806274, 0.005161716137081385, 0.0004297721025068313, -0.0047897337935864925, 0.005775022320449352, -0.0019442603224888444, -0.007232870906591415, 0.02022389881312847, -0.03642120212316513]') AS similarity FROM ucr_chan_model.kn_inst_base b , ucr_chan_model.kn_inst_embedding e where  b.kn_id = e.kn_id  and e.embedding_type in ('3','4')  order by similarity offset 0 limit 1000";
        ss = SQLExecutor.queryList(Map.class,sql);
        System.out.println(SimpleStringUtil.object2json(ss));
        
    }

    @Test
    public   void testDBPanwei() throws SQLException {
//        SQLUtil.startPool("test",//数据源名称
//                "com.github.housepower.jdbc.ClickHouseDriver",//oracle驱动
//                "jdbc:clickhouse://101.13.6.4:29000,101.13.6.7:29000,101.13.6.6:29000/visualops",//oracle rac链接串
//                "default",null,//数据库账号和口令
//                "select 1 " //数据库连接校验sql
//        );//初始化数据源

        DBConf tempConf = new DBConf();
        tempConf.setPoolname("test");
        tempConf.setDriver("org.postgresql.Driver");
        tempConf.setJdbcurl( "jdbc:postgresql://10.13.6.127:17700/visualops?currentSchema=visualops");
        tempConf.setUsername("baseadmin");
        tempConf.setPassword("&xxXzz3139%**");
        tempConf.setValidationQuery("select 1 ");
        //tempConf.setTxIsolationLevel("READ_COMMITTED");
        tempConf.setJndiName("jndi-test");
        PropertiesContainer propertiesContainer = PropertiesUtil.getPropertiesContainer();
        int initialConnections = propertiesContainer.getIntProperty("initialConnections",5);
        tempConf.setInitialConnections(initialConnections);
        int minimumSize = propertiesContainer.getIntProperty("minimumSize",5);
        tempConf.setMinimumSize(minimumSize);
        int maximumSize = propertiesContainer.getIntProperty("maximumSize",10);
        tempConf.setMaximumSize(maximumSize);
        tempConf.setUsepool(true);

        boolean showsql = propertiesContainer.getBooleanProperty("showsql",true);
        tempConf.setShowsql(showsql);
        tempConf.setQueryfetchsize(null);


        SQLManager.startPool(tempConf);
        List<Map> ddd = SQLExecutor.queryList(Map.class,"select * from webdetector_url offset ? limit ? ",0,1);
        System.out.println(SimpleStringUtil.object2json(ddd));
        ListInfo datas = SQLExecutor.queryListInfo(Map.class,"select * from webdetector_url",0,2);
        System.out.println(SimpleStringUtil.object2json(datas));

    }
    

     
    

}
